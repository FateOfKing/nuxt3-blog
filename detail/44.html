<!DOCTYPE html>
<html  data-head-attrs="">

<head >
  <meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="head:count" content="2"><link rel="modulepreload" href="/_nuxt/entry-e3bf669f.mjs" as="script" crossorigin><link rel="preload" href="/_nuxt/entry.20072ffb.css" as="style"><link rel="modulepreload" href="/_nuxt/_id_-2f9e75cb.mjs" as="script" crossorigin><link rel="modulepreload" href="/_nuxt/article-5063870b.mjs" as="script" crossorigin><link rel="modulepreload" href="/_nuxt/index-ed8b9815.mjs" as="script" crossorigin><link rel="prefetch" href="/_nuxt/avatar.a4306ac7.jpg"><link rel="prefetch" as="script" href="/_nuxt/archive-1476bd1a.mjs"><link rel="prefetch" as="script" href="/_nuxt/pageContainer-0a29b848.mjs"><link rel="prefetch" as="script" href="/_nuxt/index-901a2f28.mjs"><link rel="prefetch" as="script" href="/_nuxt/life-2a467d13.mjs"><link rel="prefetch" as="script" href="/_nuxt/skillSample-4191f538.mjs"><link rel="stylesheet" href="/_nuxt/entry.20072ffb.css">
</head>

<body  data-head-attrs="">
  <div id="__nuxt"><!--[--><!--[--><div class="bg-gray-page-bg-color h-screen" data-v-f59aa03c><div class="flex justify-center bg-black-bg-color" data-v-f59aa03c data-v-3cc81b26><div class="flex container h-[3.5rem] leading-[3.5rem] text-white px-5" data-v-3cc81b26><a href="/" class="site-title" data-v-3cc81b26>CarleBlog.com</a><span class="head-title-container" data-v-3cc81b26><a href="/" class="head-title" data-v-3cc81b26>博客首页</a></span><span class="head-title-container" data-v-3cc81b26><a href="/archive" class="head-title" data-v-3cc81b26>归档文章</a></span><span class="head-title-container" data-v-3cc81b26><a href="/skillSample" class="head-title" data-v-3cc81b26>技能展示</a></span></div></div><div class="container h-full mx-auto main clear-fix px-10" data-v-f59aa03c><div class="center bg-white mt-5 p-5" data-v-f59aa03c><div data-v-f59aa03c><div class="text-black text-xl font-bold text-center" data-v-f59aa03c>weex笔记（1）weex提升编译速度</div><div class="text-sm text-gray-400 text-center mt-3" data-v-f59aa03c>2020-7-17</div><div data-v-f59aa03c><p>每次weex编译都会卡在asset optimization 94% </p>
<p>最新新版本weex-toolkit 脚手架会不会有这问题。</p>
<p>老版本需要做如下修改</p>
<p>webpack.dev.conf.js 文件中修改html-webpack-plugin为html-webpack-plugin-for-multihtml</p>
<pre><code><span class="hljs-attribute">const HtmlWebpackPlugin</span> = require(<span class="hljs-string">&#x27;html-webpack-plugin-for-multihtml&#x27;</span>);
</code></pre>
<p>并在声明HtmlWebpackPlugin的地方加上multihtmlCache: true</p>
<pre><code><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">generateHtmlWebpackPlugin</span> = (entry) =&gt; {
  let entrys = Object.<span class="hljs-title function_ invoke__">keys</span>(entry);
  <span class="hljs-comment">// exclude vendor entry.</span>
  entrys = entrys.<span class="hljs-title function_ invoke__">filter</span>(entry =&gt; entry !== <span class="hljs-string">&#x27;vendor&#x27;</span> );
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">htmlPlugin</span> = entrys.<span class="hljs-title function_ invoke__">map</span>(name =&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>({
      <span class="hljs-attr">multihtmlCache</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">filename</span>: name + <span class="hljs-string">&#x27;.html&#x27;</span>,
      <span class="hljs-attr">template</span>: helper.<span class="hljs-title function_ invoke__">rootNode</span>(`web/index.html`),
      <span class="hljs-attr">isDevServer</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">chunksSortMode</span>: <span class="hljs-string">&#x27;dependency&#x27;</span>,
      <span class="hljs-attr">inject</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">devScripts</span>: config.dev.htmlOptions.devScripts,
      <span class="hljs-attr">chunks</span>: [<span class="hljs-string">&#x27;vendor&#x27;</span>, name]
    })
  })
  <span class="hljs-keyword">return</span> htmlPlugin;
}
</code></pre>
<p>最后安装一下新module html-webpack-plugin-for-multihtml
在工程根目录npm install html-webpack-plugin-for-multihtml</p>
</div></div></div></div></div><!--]--><!--]--></div><script>window.__NUXT__={data:{pinia:{},urql:{"2323062195":{data:"{\"getArticle\":{\"id\":44,\"title\":\"weex笔记（1）weex提升编译速度\",\"article_content\":\"每次weex编译都会卡在asset optimization 94% \\n\\n最新新版本weex-toolkit 脚手架会不会有这问题。\\n\\n老版本需要做如下修改\\n\\nwebpack.dev.conf.js 文件中修改html-webpack-plugin为html-webpack-plugin-for-multihtml\\n\\n```\\nconst HtmlWebpackPlugin = require('html-webpack-plugin-for-multihtml');\\n```\\n\\n并在声明HtmlWebpackPlugin的地方加上multihtmlCache: true\\n\\n\\n```\\nconst generateHtmlWebpackPlugin = (entry) =\u003E {\\n  let entrys = Object.keys(entry);\\n  \u002F\u002F exclude vendor entry.\\n  entrys = entrys.filter(entry =\u003E entry !== 'vendor' );\\n  const htmlPlugin = entrys.map(name =\u003E {\\n    return new HtmlWebpackPlugin({\\n      multihtmlCache: true,\\n      filename: name + '.html',\\n      template: helper.rootNode(`web\u002Findex.html`),\\n      isDevServer: true,\\n      chunksSortMode: 'dependency',\\n      inject: true,\\n      devScripts: config.dev.htmlOptions.devScripts,\\n      chunks: ['vendor', name]\\n    })\\n  })\\n  return htmlPlugin;\\n}\\n```\\n\\n最后安装一下新module html-webpack-plugin-for-multihtml\\n在工程根目录npm install html-webpack-plugin-for-multihtml\\n\",\"addTime\":1594964726,\"view_content\":0,\"type_id\":\"4\",\"__typename\":\"ArticleDto\"}}"}}},state:{error:null},_errors:{},serverRendered:true,config:{public:{},app:{baseURL:"\u002F",buildAssetsDir:"\u002F_nuxt\u002F",cdnURL:""}},__URQL_DATA__:{}}</script><script type="module" src="/_nuxt/entry-e3bf669f.mjs" crossorigin></script><script type="module" src="/_nuxt/_id_-2f9e75cb.mjs" crossorigin></script>
</body>

</html>