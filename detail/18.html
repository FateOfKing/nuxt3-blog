<!DOCTYPE html>
<html  data-head-attrs="">

<head >
  <meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="head:count" content="2"><link rel="modulepreload" href="/_nuxt/entry-319487b1.mjs" as="script" crossorigin><link rel="preload" href="/_nuxt/entry.20072ffb.css" as="style"><link rel="modulepreload" href="/_nuxt/_id_-6ab99177.mjs" as="script" crossorigin><link rel="modulepreload" href="/_nuxt/article-1163c457.mjs" as="script" crossorigin><link rel="modulepreload" href="/_nuxt/index-ed8b9815.mjs" as="script" crossorigin><link rel="prefetch" href="/_nuxt/avatar.a4306ac7.jpg"><link rel="prefetch" as="script" href="/_nuxt/archive-bfc2a89a.mjs"><link rel="prefetch" as="script" href="/_nuxt/pageContainer-d2d3df7d.mjs"><link rel="prefetch" as="script" href="/_nuxt/index-3a82c549.mjs"><link rel="prefetch" as="script" href="/_nuxt/life-2a467d13.mjs"><link rel="prefetch" as="script" href="/_nuxt/skillSample-472ea8f3.mjs"><link rel="stylesheet" href="/_nuxt/entry.20072ffb.css">
</head>

<body  data-head-attrs="">
  <div id="__nuxt"><!--[--><!--[--><div class="bg-gray-page-bg-color h-screen" data-v-f59aa03c><div class="flex justify-center bg-black-bg-color" data-v-f59aa03c data-v-3cc81b26><div class="flex container h-[3.5rem] leading-[3.5rem] text-white px-5" data-v-3cc81b26><a href="/" class="site-title" data-v-3cc81b26>CarleBlog.com</a><span class="head-title-container" data-v-3cc81b26><a href="/" class="head-title" data-v-3cc81b26>博客首页</a></span><span class="head-title-container" data-v-3cc81b26><a href="/archive" class="head-title" data-v-3cc81b26>归档文章</a></span><span class="head-title-container" data-v-3cc81b26><a href="/skillSample" class="head-title" data-v-3cc81b26>技能展示</a></span></div></div><div class="container h-full mx-auto main clear-fix px-10" data-v-f59aa03c><div class="center bg-white mt-5 p-5" data-v-f59aa03c><div data-v-f59aa03c><div class="text-black text-xl font-bold text-center" data-v-f59aa03c>Xcode11--iOS13-中coredata强转崩溃-Could-not-cast-value-of-type-NSManagedObj</div><div class="text-sm text-gray-400 text-center mt-3" data-v-f59aa03c>2020-7-16</div><div data-v-f59aa03c><h3 id="一般情况">一般情况</h3>
<p>iOS中coredata 如果需要某个表指定一个类只需要在xcode中设置即可。
例如：<img src="https://upload-images.jianshu.io/upload_images/12634286-7f3c23e46d8a0e17.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png">
红框部分就是设置的地方。
对应的声明就是</p>
<pre><code><span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span>: NSManagedObject {

    @NSManaged <span class="hljs-keyword">var</span> oId: <span class="hljs-built_in">String</span>
}
</code></pre>
<h3 id="ios-13后">iOS 13后</h3>
<p>但是升级到iOS13后出现了新问题。在iOS13之前的手机上运行</p>
<pre><code><span class="hljs-keyword">let</span> a = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">NSEntityDescription</span>.</span></span>insert<span class="hljs-constructor">NewObject(<span class="hljs-params">forEntityName</span>: <span class="hljs-params">className</span>, <span class="hljs-params">into</span>:<span class="hljs-params">managedObjectContext</span>!)</span> <span class="hljs-keyword">as</span>! Order
</code></pre>
<p>完全没问题。iOS 13上就会崩溃。报错信息类似这种</p>
<blockquote>
<p>Could not cast value of type &#39;NSManagedObject_Order_&#39; (0x600000177960) to xxxx</p>
</blockquote>
<p>经过一番摸索找到了问题修改办法。</p>
<h3 id="解决办法">解决办法</h3>
<p>1 将coredata设置的<code>Current Product Module</code>删除（红框部分）
<img src="https://upload-images.jianshu.io/upload_images/12634286-69a63112342fbeb5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>2 在Order.swift文件中加入<code>@objc(Order)</code></p>
<pre><code><span class="hljs-keyword">import</span> Foundation
<span class="hljs-keyword">import</span> CoreData
<span class="hljs-meta">@objc(Order)</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Order</span>: <span class="hljs-type">NSManagedObject {</span></span>

    <span class="hljs-meta">@NSManaged</span> <span class="hljs-keyword">var</span> oId: String
   
}
</code></pre>
</div></div></div></div></div><!--]--><!--]--></div><script>window.__NUXT__={data:{pinia:{},urql:{"2323059060":{data:"{\"getArticle\":{\"id\":18,\"title\":\"Xcode11--iOS13-中coredata强转崩溃-Could-not-cast-value-of-type-NSManagedObj\",\"article_content\":\"### 一般情况\\niOS中coredata 如果需要某个表指定一个类只需要在xcode中设置即可。\\n例如：![image.png](https:\u002F\u002Fupload-images.jianshu.io\u002Fupload_images\u002F12634286-7f3c23e46d8a0e17.png?imageMogr2\u002Fauto-orient\u002Fstrip%7CimageView2\u002F2\u002Fw\u002F1240)\\n红框部分就是设置的地方。\\n对应的声明就是\\n```\\nclass Order: NSManagedObject {\\n\\n    @NSManaged var oId: String\\n}\\n```\\n\\n### iOS 13后\\n但是升级到iOS13后出现了新问题。在iOS13之前的手机上运行\\n```\\nlet a = NSEntityDescription.insertNewObject(forEntityName: className, into:managedObjectContext!) as! Order\\n```\\n完全没问题。iOS 13上就会崩溃。报错信息类似这种\\n\u003E Could not cast value of type 'NSManagedObject_Order_' (0x600000177960) to xxxx\\n\\n经过一番摸索找到了问题修改办法。\\n\\n### 解决办法\\n\\n1 将coredata设置的`Current Product Module`删除（红框部分）\\n![image.png](https:\u002F\u002Fupload-images.jianshu.io\u002Fupload_images\u002F12634286-69a63112342fbeb5.png?imageMogr2\u002Fauto-orient\u002Fstrip%7CimageView2\u002F2\u002Fw\u002F1240)\\n\\n2 在Order.swift文件中加入`@objc(Order)`\\n```\\nimport Foundation\\nimport CoreData\\n@objc(Order)\\n\\nclass Order: NSManagedObject {\\n\\n    @NSManaged var oId: String\\n   \\n}\\n```\\n\",\"addTime\":1594877324,\"view_content\":0,\"type_id\":\"4\",\"__typename\":\"ArticleDto\"}}"}}},state:{error:null},_errors:{},serverRendered:true,config:{public:{},app:{baseURL:"\u002F",buildAssetsDir:"\u002F_nuxt\u002F",cdnURL:""}},__URQL_DATA__:{}}</script><script type="module" src="/_nuxt/entry-319487b1.mjs" crossorigin></script><script type="module" src="/_nuxt/_id_-6ab99177.mjs" crossorigin></script>
</body>

</html>